import cirq
import math

def oracle_circuit():
    n = 5
    cycles = [
        ['00000', '11101', '22202'],
        ['00001', '11102', '22200'],
        ['00002', '11100', '22201'],
        ['00010', '11111', '22212'],
        ['00011', '11112', '22210'],
        ['00012', '11110', '22211'],
        ['00020', '11121', '22222'],
        ['00021', '11122', '22220'],
        ['00022', '11120', '22221'],
        ['00100', '11201', '22002'],
        ['00101', '11202', '22000'],
        ['00102', '11200', '22001'],
        ['00110', '11211', '22012'],
        ['00111', '11212', '22010'],
        ['00112', '11210', '22011'],
        ['00120', '11221', '22022'],
        ['00121', '11222', '22020'],
        ['00122', '11220', '22021'],
        ['00200', '11001', '22102'],
        ['00201', '11002', '22100'],
        ['00202', '11000', '22101'],
        ['00210', '11011', '22112'],
        ['00211', '11012', '22110'],
        ['00212', '11010', '22111'],
        ['00220', '11021', '22122'],
        ['00221', '11022', '22120'],
        ['00222', '11020', '22121'],
        ['01000', '12101', '20202'],
        ['01001', '12102', '20200'],
        ['01002', '12100', '20201'],
        ['01010', '12111', '20212'],
        ['01011', '12112', '20210'],
        ['01012', '12110', '20211'],
        ['01020', '12121', '20222'],
        ['01021', '12122', '20220'],
        ['01022', '12120', '20221'],
        ['01100', '12201', '20002'],
        ['01101', '12202', '20000'],
        ['01102', '12200', '20001'],
        ['01110', '12211', '20012'],
        ['01111', '12212', '20010'],
        ['01112', '12210', '20011'],
        ['01120', '12221', '20022'],
        ['01121', '12222', '20020'],
        ['01122', '12220', '20021'],
        ['01200', '12001', '20102'],
        ['01201', '12002', '20100'],
        ['01202', '12000', '20101'],
        ['01210', '12011', '20112'],
        ['01211', '12012', '20110'],
        ['01212', '12010', '20111'],
        ['01220', '12021', '20122'],
        ['01221', '12022', '20120'],
        ['01222', '12020', '20121'],
        ['02000', '10101', '21202'],
        ['02001', '10102', '21200'],
        ['02002', '10100', '21201'],
        ['02010', '10111', '21212'],
        ['02011', '10112', '21210'],
        ['02012', '10110', '21211'],
        ['02020', '10121', '21222'],
        ['02021', '10122', '21220'],
        ['02022', '10120', '21221'],
        ['02100', '10201', '21002'],
        ['02101', '10202', '21000'],
        ['02102', '10200', '21001'],
        ['02110', '10211', '21012'],
        ['02111', '10212', '21010'],
        ['02112', '10210', '21011'],
        ['02120', '10221', '21022'],
        ['02121', '10222', '21020'],
        ['02122', '10220', '21021'],
        ['02200', '10001', '21102'],
        ['02201', '10002', '21100'],
        ['02202', '10000', '21101'],
        ['02210', '10011', '21112'],
        ['02211', '10012', '21110'],
        ['02212', '10010', '21111'],
        ['02220', '10021', '21122'],
        ['02221', '10022', '21120'],
        ['02222', '10020', '21121'],
    ]
    m = max(1, math.ceil(math.log2(len(cycles))))
    q = cirq.LineQubit.range(2*n + m)
    x = q[:2*n]
    y = q[2*n:2*n+m]
    circuit = cirq.Circuit()

    def enc_digit(d):
        return '00' if d=='0' else '01' if d=='1' else '10'

    for cidx, cyc in enumerate(cycles):
        bin_idx = format(cidx, f'0{m}b')
        for k, bit in enumerate(bin_idx):
            if bit != '1':
                continue
            for v in cyc:
                patt = ''.join(enc_digit(d) for d in v)
                controls = [x[i] for i in range(2*n)]
                cvals = tuple(1 if ch=='1' else 0 for ch in patt)
                op = cirq.X(y[k]).controlled_by(*controls, control_values=cvals)
                circuit.append(op)

    return circuit
