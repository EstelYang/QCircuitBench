import cirq
import math

def oracle_circuit():
    n = 6
    cycles = [
        ['000000', '111110', '222220'],
        ['000001', '111111', '222221'],
        ['000002', '111112', '222222'],
        ['000010', '111120', '222200'],
        ['000011', '111121', '222201'],
        ['000012', '111122', '222202'],
        ['000020', '111100', '222210'],
        ['000021', '111101', '222211'],
        ['000022', '111102', '222212'],
        ['000100', '111210', '222020'],
        ['000101', '111211', '222021'],
        ['000102', '111212', '222022'],
        ['000110', '111220', '222000'],
        ['000111', '111221', '222001'],
        ['000112', '111222', '222002'],
        ['000120', '111200', '222010'],
        ['000121', '111201', '222011'],
        ['000122', '111202', '222012'],
        ['000200', '111010', '222120'],
        ['000201', '111011', '222121'],
        ['000202', '111012', '222122'],
        ['000210', '111020', '222100'],
        ['000211', '111021', '222101'],
        ['000212', '111022', '222102'],
        ['000220', '111000', '222110'],
        ['000221', '111001', '222111'],
        ['000222', '111002', '222112'],
        ['001000', '112110', '220220'],
        ['001001', '112111', '220221'],
        ['001002', '112112', '220222'],
        ['001010', '112120', '220200'],
        ['001011', '112121', '220201'],
        ['001012', '112122', '220202'],
        ['001020', '112100', '220210'],
        ['001021', '112101', '220211'],
        ['001022', '112102', '220212'],
        ['001100', '112210', '220020'],
        ['001101', '112211', '220021'],
        ['001102', '112212', '220022'],
        ['001110', '112220', '220000'],
        ['001111', '112221', '220001'],
        ['001112', '112222', '220002'],
        ['001120', '112200', '220010'],
        ['001121', '112201', '220011'],
        ['001122', '112202', '220012'],
        ['001200', '112010', '220120'],
        ['001201', '112011', '220121'],
        ['001202', '112012', '220122'],
        ['001210', '112020', '220100'],
        ['001211', '112021', '220101'],
        ['001212', '112022', '220102'],
        ['001220', '112000', '220110'],
        ['001221', '112001', '220111'],
        ['001222', '112002', '220112'],
        ['002000', '110110', '221220'],
        ['002001', '110111', '221221'],
        ['002002', '110112', '221222'],
        ['002010', '110120', '221200'],
        ['002011', '110121', '221201'],
        ['002012', '110122', '221202'],
        ['002020', '110100', '221210'],
        ['002021', '110101', '221211'],
        ['002022', '110102', '221212'],
        ['002100', '110210', '221020'],
        ['002101', '110211', '221021'],
        ['002102', '110212', '221022'],
        ['002110', '110220', '221000'],
        ['002111', '110221', '221001'],
        ['002112', '110222', '221002'],
        ['002120', '110200', '221010'],
        ['002121', '110201', '221011'],
        ['002122', '110202', '221012'],
        ['002200', '110010', '221120'],
        ['002201', '110011', '221121'],
        ['002202', '110012', '221122'],
        ['002210', '110020', '221100'],
        ['002211', '110021', '221101'],
        ['002212', '110022', '221102'],
        ['002220', '110000', '221110'],
        ['002221', '110001', '221111'],
        ['002222', '110002', '221112'],
        ['010000', '121110', '202220'],
        ['010001', '121111', '202221'],
        ['010002', '121112', '202222'],
        ['010010', '121120', '202200'],
        ['010011', '121121', '202201'],
        ['010012', '121122', '202202'],
        ['010020', '121100', '202210'],
        ['010021', '121101', '202211'],
        ['010022', '121102', '202212'],
        ['010100', '121210', '202020'],
        ['010101', '121211', '202021'],
        ['010102', '121212', '202022'],
        ['010110', '121220', '202000'],
        ['010111', '121221', '202001'],
        ['010112', '121222', '202002'],
        ['010120', '121200', '202010'],
        ['010121', '121201', '202011'],
        ['010122', '121202', '202012'],
        ['010200', '121010', '202120'],
        ['010201', '121011', '202121'],
        ['010202', '121012', '202122'],
        ['010210', '121020', '202100'],
        ['010211', '121021', '202101'],
        ['010212', '121022', '202102'],
        ['010220', '121000', '202110'],
        ['010221', '121001', '202111'],
        ['010222', '121002', '202112'],
        ['011000', '122110', '200220'],
        ['011001', '122111', '200221'],
        ['011002', '122112', '200222'],
        ['011010', '122120', '200200'],
        ['011011', '122121', '200201'],
        ['011012', '122122', '200202'],
        ['011020', '122100', '200210'],
        ['011021', '122101', '200211'],
        ['011022', '122102', '200212'],
        ['011100', '122210', '200020'],
        ['011101', '122211', '200021'],
        ['011102', '122212', '200022'],
        ['011110', '122220', '200000'],
        ['011111', '122221', '200001'],
        ['011112', '122222', '200002'],
        ['011120', '122200', '200010'],
        ['011121', '122201', '200011'],
        ['011122', '122202', '200012'],
        ['011200', '122010', '200120'],
        ['011201', '122011', '200121'],
        ['011202', '122012', '200122'],
        ['011210', '122020', '200100'],
        ['011211', '122021', '200101'],
        ['011212', '122022', '200102'],
        ['011220', '122000', '200110'],
        ['011221', '122001', '200111'],
        ['011222', '122002', '200112'],
        ['012000', '120110', '201220'],
        ['012001', '120111', '201221'],
        ['012002', '120112', '201222'],
        ['012010', '120120', '201200'],
        ['012011', '120121', '201201'],
        ['012012', '120122', '201202'],
        ['012020', '120100', '201210'],
        ['012021', '120101', '201211'],
        ['012022', '120102', '201212'],
        ['012100', '120210', '201020'],
        ['012101', '120211', '201021'],
        ['012102', '120212', '201022'],
        ['012110', '120220', '201000'],
        ['012111', '120221', '201001'],
        ['012112', '120222', '201002'],
        ['012120', '120200', '201010'],
        ['012121', '120201', '201011'],
        ['012122', '120202', '201012'],
        ['012200', '120010', '201120'],
        ['012201', '120011', '201121'],
        ['012202', '120012', '201122'],
        ['012210', '120020', '201100'],
        ['012211', '120021', '201101'],
        ['012212', '120022', '201102'],
        ['012220', '120000', '201110'],
        ['012221', '120001', '201111'],
        ['012222', '120002', '201112'],
        ['020000', '101110', '212220'],
        ['020001', '101111', '212221'],
        ['020002', '101112', '212222'],
        ['020010', '101120', '212200'],
        ['020011', '101121', '212201'],
        ['020012', '101122', '212202'],
        ['020020', '101100', '212210'],
        ['020021', '101101', '212211'],
        ['020022', '101102', '212212'],
        ['020100', '101210', '212020'],
        ['020101', '101211', '212021'],
        ['020102', '101212', '212022'],
        ['020110', '101220', '212000'],
        ['020111', '101221', '212001'],
        ['020112', '101222', '212002'],
        ['020120', '101200', '212010'],
        ['020121', '101201', '212011'],
        ['020122', '101202', '212012'],
        ['020200', '101010', '212120'],
        ['020201', '101011', '212121'],
        ['020202', '101012', '212122'],
        ['020210', '101020', '212100'],
        ['020211', '101021', '212101'],
        ['020212', '101022', '212102'],
        ['020220', '101000', '212110'],
        ['020221', '101001', '212111'],
        ['020222', '101002', '212112'],
        ['021000', '102110', '210220'],
        ['021001', '102111', '210221'],
        ['021002', '102112', '210222'],
        ['021010', '102120', '210200'],
        ['021011', '102121', '210201'],
        ['021012', '102122', '210202'],
        ['021020', '102100', '210210'],
        ['021021', '102101', '210211'],
        ['021022', '102102', '210212'],
        ['021100', '102210', '210020'],
        ['021101', '102211', '210021'],
        ['021102', '102212', '210022'],
        ['021110', '102220', '210000'],
        ['021111', '102221', '210001'],
        ['021112', '102222', '210002'],
        ['021120', '102200', '210010'],
        ['021121', '102201', '210011'],
        ['021122', '102202', '210012'],
        ['021200', '102010', '210120'],
        ['021201', '102011', '210121'],
        ['021202', '102012', '210122'],
        ['021210', '102020', '210100'],
        ['021211', '102021', '210101'],
        ['021212', '102022', '210102'],
        ['021220', '102000', '210110'],
        ['021221', '102001', '210111'],
        ['021222', '102002', '210112'],
        ['022000', '100110', '211220'],
        ['022001', '100111', '211221'],
        ['022002', '100112', '211222'],
        ['022010', '100120', '211200'],
        ['022011', '100121', '211201'],
        ['022012', '100122', '211202'],
        ['022020', '100100', '211210'],
        ['022021', '100101', '211211'],
        ['022022', '100102', '211212'],
        ['022100', '100210', '211020'],
        ['022101', '100211', '211021'],
        ['022102', '100212', '211022'],
        ['022110', '100220', '211000'],
        ['022111', '100221', '211001'],
        ['022112', '100222', '211002'],
        ['022120', '100200', '211010'],
        ['022121', '100201', '211011'],
        ['022122', '100202', '211012'],
        ['022200', '100010', '211120'],
        ['022201', '100011', '211121'],
        ['022202', '100012', '211122'],
        ['022210', '100020', '211100'],
        ['022211', '100021', '211101'],
        ['022212', '100022', '211102'],
        ['022220', '100000', '211110'],
        ['022221', '100001', '211111'],
        ['022222', '100002', '211112'],
    ]
    m = max(1, math.ceil(math.log2(len(cycles))))
    q = cirq.LineQubit.range(2*n + m)
    x = q[:2*n]
    y = q[2*n:2*n+m]
    circuit = cirq.Circuit()

    def enc_digit(d):
        return '00' if d=='0' else '01' if d=='1' else '10'

    for cidx, cyc in enumerate(cycles):
        bin_idx = format(cidx, f'0{m}b')
        for k, bit in enumerate(bin_idx):
            if bit != '1':
                continue
            for v in cyc:
                patt = ''.join(enc_digit(d) for d in v)
                controls = [x[i] for i in range(2*n)]
                cvals = tuple(1 if ch=='1' else 0 for ch in patt)
                op = cirq.X(y[k]).controlled_by(*controls, control_values=cvals)
                circuit.append(op)

    return circuit
